<!doctype html><html><head><meta charset="UTF-8"><meta name="viewport" content="user-scalable=no,width=device-width,initial-scale=1"><title>YAS</title><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.slim.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@3/dist/js/bootstrap.min.js"></script><script src="https://cdn.jsdelivr.net/npm/html2canvas/dist/html2canvas.min.js"></script><script src="https://cdn.jsdelivr.net/npm/html-docx-js@0/dist/html-docx.js"></script><script src="https://cdn.jsdelivr.net/npm/qrcode@1/build/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="css/ha.css"><style>td{white-space:nowrap}.green{background-color:#00c832!important}.grey{background-color:#969696!important}.green,.grey{color:#fff}</style><script defer="defer" src="/PKUPI/heavens-above/static/js/main.554b7584.js"></script><link href="/PKUPI/heavens-above/static/css/main.35e8ad33.css" rel="stylesheet"></head><body><div class="navbar navbar-default"><div class="container"><div class="navbar-header"><a class="navbar-brand" href="#">YAS </a><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navBar"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><div class="collapse navbar-collapse navbar-right" id="navBar"><ul class="nav navbar-nav"><li><a href="https://github.com/PKUPI/heavens-above" target="_blank">开源</a></li><li><a href="https://www.heavens-above.com" target="_blank">数据</a></li><li class="dropdown" id="drop"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">手机浏览 <span class="caret"></span></a><ul class="dropdown-menu" aria-labelledby="dropdown"><li><a href="javascript:void(0)">扫码打开本页面</a></li><li><img id="qrcode" style="width:100%"><script>(/mobile/i.test(navigator.userAgent)||/mobile/i.test(navigator.appVersion))&&$("#drop").hide(),QRCode.toDataURL(location.href,{margin:1},((t,e)=>{$("#qrcode").attr("src",e)}))</script></li></ul></li></ul></div></div></div><div class="container"><h1>国际空间站（ISS）过境</h1></div><div class="container satellite" style="overflow-x:scroll"><table class="table table-striped table-bordered"><thead><tr><td align="center" rowspan="2" style="vertical-align:middle">选择</td><td align="center" rowspan="2" style="vertical-align:middle">推荐度</td><td align="center" rowspan="2" style="vertical-align:middle">日期</td><td align="center" rowspan="2" style="vertical-align:middle">持续时间</td><td align="center" rowspan="2" style="vertical-align:middle">星等</td><td align="center" rowspan="2" style="vertical-align:middle">星图</td><td align="center" colspan="6">升</td><td align="center" colspan="6">到达高度10°</td><td align="center" colspan="6">上中天</td><td align="center" colspan="6">低于高度10°</td><td align="center" colspan="6">降</td><td align="center" colspan="6">离开地影</td><td align="center" colspan="6">进入地影</td></tr><tr class="tr"></tr></thead><tbody id="satellite25544"></tbody></table></div><div class="container"><h1>铱星闪光</h1></div><div class="container iridium" style="overflow-x:scroll"><table class="table table-striped table-bordered"><thead><tr><td align="center" rowspan="2">选择</td><td align="center" rowspan="2">推荐度</td><td align="center" rowspan="2">日期</td><td align="center" rowspan="2">时间</td><td align="center" rowspan="2">星等</td><td align="center" rowspan="2">星图</td><td align="center" rowspan="2">高度角</td><td align="center" rowspan="2">方位角</td><td align="center" rowspan="2">卫星</td><td align="center" rowspan="2">至闪光中心距离</td><td align="center" rowspan="2">闪光中心亮度</td><td align="center" rowspan="2">至卫星距离</td><td align="center" rowspan="2">与闪光中心线的夹角</td><td align="center" rowspan="2">产生闪光的天线</td><td align="center" rowspan="2">太阳高度</td><td align="center" rowspan="2">对太阳的张角</td></tr><tr class="tr"></tr></thead><tbody id="IridiumFlares"></tbody></table></div><div class="container" style="margin-bottom:30px"><h1>生成天象预告</h1><h2>让撰写《天象预告》实现社会主义四个现代化中技术现代化的自动化</h2><p>请在上方表格中勾选想要出现在天象报告中的项目，然后点击「生成」<br>系统会自动获取相关图片及生成文字描述，并导出为Word文档。再点击「下载」即可保存到本地<br>卫星过境信息默认按照推荐度排序，暂时不支持根据时间排序，请等待新功能<br><b>警告：生成的Word文档为Office 2007兼容格式，秀米无法读取，请使用最新版Microsoft Word打开并选择「另存为」</b></p><p>其它天象可参考<a href="https://interesting-sky.china-vo.org" target="_blank">有趣天文奇观</a>网站</p><a class="btn btn-success" href="javascript:generate()">生成</a> <a class="btn btn-info disabled" href="#" id="download">下载</a></div><script>var names={satellite25544:"国际空间站",IridiumFlares:"铱星闪光"},property=["url","date","brightness","events","passType","image","scoreData","exist","score","id"],events=["rise","reachAltitude10deg","highestPoint","dropBelowAltitude10deg","set","exitShadow","enterShadow"],attribute=["time","altitude","azimuth","distance","brightness","sunAltitude"],eventsIridium=["brightness","altitude","azimuth","satellite","distanceToFlareCentre","brightnessAtFlareCentre","date","time","distanceToSatellite","AngleOffFlareCentre-line","flareProducingAntenna","sunAltitude","angularSeparationFromSun","image","id"];function appendThead(){$(".satellite .tr").append('\n\t\t\t\t<td align="center">\n\t\t\t\t\t时间\n\t\t\t\t</td>\n\t\t\t\t<td align="center">\n\t\t\t\t\t高度角\n\t\t\t\t</td>\n\t\t\t\t<td align="center">\n\t\t\t\t\t方位角\n\t\t\t\t</td>\n\t\t\t\t<td align="center">\n\t\t\t\t\t距离\n\t\t\t\t</td>\n\t\t\t\t<td align="center">\n\t\t\t\t\t星等\n\t\t\t\t</td>\n\t\t\t\t<td align="center">\n\t\t\t\t\t太阳高度\n\t\t\t\t</td>')}function showData(t,e){fetch(`data/${t}/index.json`).then((t=>t.json())).then((n=>{0===e?n.forEach((function(e,n){for(var a=`<td><input type="checkbox" class="${t}" id="${e[property[9]]}"></td>\n\t\t\t\t\t<td>${e[property[8]]}</td>\n\t\t\t\t\t<td>${e[property[1]]}</td>\n\t\t\t\t\t<td>${e[property[7]]}</td>\n\t\t\t\t\t<td>${e[property[2]]}</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="download.html?target=${t}&id=${e[property[9]]}" target="_blank">查看</a>\n\t\t\t\t\t</td>`,r=0;r<7;r++)if(e[property[3]][events[r]])for(var d in e[property[3]][events[r]])a+=`<td>${e[property[3]][events[r]][d]}</td>`;else for(d=0;d<6;d++)a+="<td>N/A</td>";n<3?$("#"+t).append(`<tr class="green">${a}</tr>`):0===e[property[8]]?$("#"+t).append(`<tr class="grey">${a}</tr>`):$("#"+t).append(`<tr>${a}</tr>`)})):n.forEach((function(e,n){for(var a=`<td><input type="checkbox" class="${t}" id="${e[eventsIridium[14]]}"></td>\n\t\t\t\t\t<td>N/A</td>\n\t\t\t\t\t<td>${e[eventsIridium[6]]}</td>\n\t\t\t\t\t<td>${e[eventsIridium[7]]}</td>\n\t\t\t\t\t<td>${e[eventsIridium[0]]}</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="download.html?target=${t}&id=${e[eventsIridium[14]]}" target="_blank">查看</a>\n\t\t\t\t\t</td>`,r=[1,2,3,4,5,8,9,10,11,12],d=0;d<10;d++)a+=`<td>${e[eventsIridium[r[d]]]}</td>`;$("#"+t).append(`<tr>${a}</tr>`)}))})).catch((t=>{console.log("Error")}))}for(var i=0;i<7;i++)appendThead();function getText(t){return new Promise(((e,n)=>{e(`<p>${t}</p>`)}))}function getPic(t){return new Promise(((e,n)=>{var a=new Image;a.src=t,a.onload=function(){var t=document.createElement("canvas"),n=t.getContext("2d");t.height=this.height,t.width=this.width,n.drawImage(this,0,0),e(`<img src="${t.toDataURL()}">`)}}))}function getTable(t){return fetch(t).then((t=>t.text())).then((t=>{var e=$('<table class="standardTable"></table>');return e.html(t),$("body").append(e),html2canvas(e[0]).then((function(t){document.body.appendChild(t);var n=t.toDataURL("image/png");return document.body.removeChild(t),e.remove(),`<img src="${n}">`}))}))}function generate(){var t=$("input:checked");if(0!==t.length){var e,n,a=[];t.each((function(t,r){temp=$(r).parents("tr").children(),"IridiumFlares"===$(r).attr("class")?(e=temp.eq(2).text()+temp.eq(3).text()+" 铱星闪光",n="最大亮度 "+temp.eq(4).text()+"等"):(e=temp.eq(2).text()+temp.eq(18).text()+" "+names[$(r).attr("class")]+"过境",n="最大亮度 "+temp.eq(4).text()+"等"),a=a.concat([getText(e),getText(n),getPic(`data/${$(r).attr("class")}/${$(r).attr("id")}.png`),getTable(`data/${$(r).attr("class")}/${$(r).attr("id")}.html`)])})),Promise.all(a).then((t=>{console.log(t);var e=`<!DOCTYPE html>\n<html>\n<head>\n<meta charset="UTF-8">\n</head>\n<body>\n${t.join("\n")}\n</body>\n</html>`,n=htmlDocx.asBlob(e);$("#download").removeClass("disabled").attr("href",URL.createObjectURL(n)).attr("download","天象预告.docx")}))}else alert("没有选中项！")}showData("satellite25544",0),showData("IridiumFlares",1)</script></body></html>